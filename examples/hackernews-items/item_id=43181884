{"by": "lloeki", "id": 43181884, "parent": 43179116, "text": "&gt; bash won&#x27;t let me automatically run a command before and after each interactive command I execute, which I want for task completion notifications<p>Incorrect. This can be achieved because I&#x27;ve done it ;)<p>It relies on trap DEBUG (preexec) and PROMPT_COMMAND (precmd), but to make this much easier for me I&#x27;ve ported zsh preexec and precmd  callback support to bash:<p><a href=\"https:&#x2F;&#x2F;github.com&#x2F;lloeki&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;bash&#x2F;ext\">https:&#x2F;&#x2F;github.com&#x2F;lloeki&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;bash&#x2F;ext</a><p>Then with those callbacks now available it is quite easy to e.g compute time between command start and command end:<p><a href=\"https:&#x2F;&#x2F;github.com&#x2F;lloeki&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;bash&#x2F;rc\">https:&#x2F;&#x2F;github.com&#x2F;lloeki&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;bash&#x2F;rc</a><p>(The time thing is commented out because I don&#x27;t need it right now, I used it to display command exec time on the prompt. Note that bash  EPOCHREALTIME has second-level precision)<p>And from there notifying completion of commands that run longer than X is absolutely trivial.<p>Other things I&#x27;ve &quot;backported&quot;:<p>- chpwd callback<p>- the %\\n thing on lack of newline in command output<p>- PROMPT and RPROMPT<p>- zprompt colors", "time": 1740558683, "type": "comment"}